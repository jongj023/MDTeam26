<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <!--<meta name="_csrf" th:content="${_csrf.token}"/>-->
    <title>Locker overview</title>
    <link href="../../../webapp/resources/css/bootstrap.css" rel="stylesheet" media="screen" th:href="@{/resources/css/bootstrap.css}"/>
    <link href="../../../webapp/resources/css/bootstrap-theme.css" rel="stylesheet" media="screen" th:href="@{/resources/css/bootstrap-theme.css}"/>
    <link href="../../../webapp/resources/css/login.css" rel="stylesheet" media="screen" th:href="@{/resources/css/login.css}"/>
    <link href="../../../webapp/resources/css/locker.css" rel="stylesheet" media="screen" th:href="@{/resources/css/locker.css}"/>
    <link href="../../../webapp/resources/css/typeaheadjs.css" rel="stylesheet" media="screen" th:href="@{/resources/css/typeaheadjs.css}"/>

    <script src="../../../webapp/resources/js/jquery-min.js" th:src="@{/resources/js/jquery-min.js}"></script>
    <script src="../../../webapp/resources/js/typeahead.js" th:src="@{/resources/js/typeahead.js}"></script>
    <script src="../../../webapp/resources/js/bootstrap.js" th:src="@{/resources/js/bootstrap.js}"></script>
    <script src="../../../webapp/resources/js/locker.js" th:src="@{/resources/js/locker.js}"></script>
    <script type="text/javascript" src="http://mottie.github.com/tablesorter/js/jquery.tablesorter.js"></script>
    <script>
        $(document).ready(function() {
            $('#locker_table').tablesorter({sortList: [[0,0],[1,0]]});
        });
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/> <!-- fixes mobile view -->
</head>

<body>

<div class="container">
    <div class="row" id="title">
        <div class="col-md-2 col-xs-2">
            <img class="" th:src="@{/resources/images/KluisButton.png}"/>
        </div>
        <div class="col-md-10 col-xs-6 col-xs-offset-3 col-md-offset-0 title">
            <h1 title="List of all lockers">Locker overview</h1>
        </div>
    </div>
    <div class="input-group col-md-12 col-xs-10 col-xs-offset-1 col-md-offset-0" id="search-field">
        <input name="search" id="search" class="form-control" placeholder="Search..."  type="text" aria-label="help"/>
        <div class="input-group-btn">
            <button onclick="location.href='/help';" class="btn-primary btn"><span class="glyphicon glyphicon-question-sign"></span></button>
        </div>
    </div>
    <div class="table-responsive dropdown-reserve" align="center">
        <table class="table table-hover table-striped" id="locker_table">
            <thead>
            <tr class="hidden-xs">
                <th>#</th>
                <th>Tower</th>
                <th>Floor</th>
                <th>Number</th>
                <th>User</th>
                <th>Actions</th>
                <th>Hidden</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="locker : ${lockers}" class="locker-row" th:attr="data-id=${locker.lockerid}">
                <td class="col-xs-1 col-md-1" th:text="${locker.lockerid}">0</td>
                <td class="col-xs-1 col-md-1searchable" th:text="${locker.lockerTower}">A</td>
                <td class="col-xs-1 col-md-1" th:text="${locker.lockerFloor}">0</td>
                <td class="col-xs-1 col-md-1" th:text="${locker.lockerNumber}">0</td>
                <td class="col-xs-4 col-md-4" th:attr="id='user' + ${locker.lockerid}" th:text="${locker.user}">Karel</td>
                <td class="col-xs-4 col-md-4 actions-column">
                    <div class="btn-group" role="group" aria-label="actions-group">
                        <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#lockerModal" th:attr="id=${locker.lockerid}">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span><span class="hidden-xs"> Assign</span></button>
                        <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="pointer" th:onclick="'viewLocker('+${locker.lockerid}+')'"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> View</a></li>
                            <li><a class="pointer" th:onclick="'clearUserFromLocker('+${locker.lockerid}+')'"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Clear</a></li>
                        </ul>
                    </div>
                </td>
                <td th:text="${locker.lockerTower} + ${locker.lockerFloor} + ${locker.lockerNumber}">A000</td>
            </tr>
            </tbody>
        </table>
    </div>
    <div id="lockerModal" class="modal fade" role="dialog" aria-labelledby="orderModalLabel" tabindex="-1">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Locker</h4>
                </div>

                <div class="modal-body">
                    <p>Assign or change user designated to this locker.</p>
                    <form id="user-form" th:action="@{/setuser}" method="post">
                        <div class="alert alert-warning" role="alert" id="lockerWithUsernameExists">
                            <button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <span id="warning-message"><p><strong>This username already has a locker!</strong> Cannot assign a second locker.</p></span>
                        </div>
                        <div class="form-group" id="locker-field">
                            <label for="locker-user" class="control-label">User:</label>
                            <input type="text" name="locker-user" class="form-control typeahead" id="locker-user" data-provide="typeahead"/>
                            <input type="hidden" name="locker-id" id="locker-id" value=""/>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-danger"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Close</button>
                    <button onclick="submitUser()" class="btn btn-warning"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
